#geodata-mode: true  # å¯ç”¨ GeoIP è§£æ  filterä¸­å¯ä½¿ç”¨ä»¥ä¸‹3ä¸ªå‚æ•°  country é€šè¿‡èŠ‚ç‚¹IPæŸ¥è¯¢MaxMindæ•°æ®åº“    city éœ€è¦liteip2cityæ‰©å±•æ•°æ®åº“    asn è‡ªæ²»ç³»ç»Ÿå· (AS12345)


# ===============è®¢é˜…æºé…ç½® (æ ¸å¿ƒéƒ¨åˆ†)==============
proxy-providers:
  provider1:
    type: http
    path: ./huancun.yaml
    url: https://gh-proxy.com/https://raw.githubusercontent.com/2530ZZZ/free/refs/heads/main/mihomo.yaml
    interval: 3600          # èŠ‚ç‚¹æ›´æ–°é—´éš”(å•ä½:ç§’)
    #filter: "(history_delay.avg < 800) && (bandwidth.download > 2)"  # æ­£ç¡®æ³¨é‡Šä½ç½®

    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204  # åŸºç¡€æ£€æµ‹URL
      initial-delay: 0            # ç«‹å³å¯åŠ¨æ£€æµ‹
      lazy: false                 # ç¦ç”¨å»¶è¿Ÿåˆå§‹åŒ–
      interval: 30               # æ£€æµ‹é—´éš”(å•ä½:ç§’)
      timeout: 2                  # è¶…æ—¶æ—¶é—´(å•ä½:ç§’)
      passing-score: 0.7          # é€šè¿‡åˆ†æ•°(å°æ•°å½¢å¼)

      # æ‰¹é‡æ£€æµ‹å‚æ•°
      concurrency: 
        batch: 999  # æ¯æ‰¹æ£€æµ‹æ•°é‡
        interval: 0ms       # æ‰¹æ¬¡é—´éš”(å•ä½:æ¯«ç§’)  0ä»£è¡¨æ— é—´éš”è¿ç»­æµ‹è¯•

      #Start initial health checkingçš„æ—¶å€™åŒ…å«æ‰€æœ‰èŠ‚ç‚¹
      proxies:
        - include: ".*"           # åŒ…å«æ‰€æœ‰èŠ‚ç‚¹
        - exclude: "DIRECT|REJECT" # æ’é™¤ç›´è¿/æ‹’ç»èŠ‚ç‚¹

      methods:
        - method: http        # å¯ç”¨æ€§æ£€æµ‹
          url: "https://www.gstatic.com/generate_204"
          timeout: 1500ms     # æ˜ç¡®æ¯«ç§’å•ä½
          weight: 1         # æƒé‡å€¼(å°æ•°å½¢å¼)

#        - method: speed       # é€Ÿåº¦æ£€æµ‹æ–¹æ³•
#          download:           # å¿…é¡»å£°æ˜æ–¹å‘
#            url: "https://github.com/AaronFeng753/Waifu2x-Extension-GUI/releases/download/v2.21.12/Waifu2x-Extension-GUI-v2.21.12-Portable.7zp"
#            size: 5242880     # 5MBè½¬æ¢ä¸ºå­—èŠ‚
#            min: 209715       # æœ€ä½0.2MB/s 0.2MB/sè½¬æ¢ä¸ºå­—èŠ‚/s(209715=0.2*1024*1024)
#            threads: "{{ min(4, env.CPU_CORES) }}" # åŠ¨æ€çº¿ç¨‹æ•°
#          timeout: 10s        # ç»Ÿä¸€ç§’å•ä½
#          weight: 0.4

      # å­˜å‚¨ä¼˜åŒ–
      storage-optimization:
        vacuum: auto          # è‡ªåŠ¨æ¸…ç†ç¢ç‰‡
        compression-level: 3  # æœ‰æ•ˆå€¼0-9


# ==============ä»£ç†èŠ‚ç‚¹ç»„(ç­–ç•¥ç»„)é…ç½®==================
proxy-groups:
  #ä¸»ä»£ç†ç»„
  - name: ğŸŒ PROXY
    type: select
    include-all: true
    proxies:
      - âš–ï¸ næ¥æº-nä»£ç†-nç›®æ ‡
#      - âš–ï¸ næ¥æº-1ä»£ç†-1ç›®æ ‡
#      - âš–ï¸ 1æ¥æº-1ä»£ç†-1ç›®æ ‡

  - name: âš–ï¸ næ¥æº-nä»£ç†-nç›®æ ‡
    type: load-balance
    use: [provider1]                  # å¤ç”¨providerçš„æ£€æŸ¥é…ç½®
    filter: > 
       health.healthy == true
    strategy: round-robin

#  - name: âš–ï¸ næ¥æº-1ä»£ç†-1ç›®æ ‡
#    type: load-balance
#    use: [provider1]                  # å¤ç”¨providerçš„æ£€æŸ¥é…ç½®
#    filter: > 
#       health.healthy == true && 
#       bandwidth.download > 0.1 && 
#       latency < 1000
#    strategy: consistent-hashing

#  - name: âš–ï¸ 1æ¥æº-1ä»£ç†-1ç›®æ ‡
#    type: load-balance
#    use: [provider1]                  # å¤ç”¨providerçš„æ£€æŸ¥é…ç½®
#    filter: > 
#       health.healthy == true && 
#       bandwidth.download > 0.1 && 
#       latency < 1000
#    strategy: sticky-sessions

# =============== è§„åˆ™ç³»ç»Ÿ ================
rule-providers:
  # ğŸ”’ç§æœ‰ç½‘ç»œ
  private:
    url: "https://gh-proxy.com/https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/private.txt"
    path: ./rules/private.yaml
    behavior: domain          # ğŸ¯åŸŸååŒ¹é…
    interval: 86400           # ğŸ”„æ¯æ—¥æ›´æ–°
    type: http                # âœ… å¿…é¡»å£°æ˜ç±»å‹
    format: text              # ğŸ“œ æ˜¾å¼å£°æ˜æ–‡æœ¬æ ¼å¼
    strategy: DIRECT          # å¼ºåˆ¶ç›´è¿ä¸‹è½½è§„åˆ™æ–‡ä»¶
    health-check: false       # å½“è§„åˆ™æ–‡ä»¶æ›´æ–°æ—¶ ä¸è§¦å‘ ä»£ç†èŠ‚ç‚¹çš„å¥åº·æ£€æŸ¥ é¿å…è§„åˆ™æ›´æ–°ä¸èŠ‚ç‚¹æ£€æµ‹äº§ç”Ÿå¾ªç¯ä¾èµ–

  # ğŸ‡¨ğŸ‡³å›½å†…åŸŸå
  cn_domain:
    type: http         # âœ… å¿…é¡»å£°æ˜ç±»å‹,typeå¿…é¡»é¦–è¡Œ,ä¸‹åŒ
    behavior: domain
    url: "https://gh-proxy.com/https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/direct.txt"
    path: ./rules/cn_domain.yaml
    interval: 172800  # ğŸ”„æ¯2å¤©æ›´æ–°
    format: text    # ğŸ“œ æ˜¾å¼å£°æ˜æ–‡æœ¬æ ¼å¼
    health-check: false       # å½“è§„åˆ™æ–‡ä»¶æ›´æ–°æ—¶ ä¸è§¦å‘ ä»£ç†èŠ‚ç‚¹çš„å¥åº·æ£€æŸ¥ é¿å…è§„åˆ™æ›´æ–°ä¸èŠ‚ç‚¹æ£€æµ‹äº§ç”Ÿå¾ªç¯ä¾èµ–

  # ğŸŒæµ·å¤–åŸŸå
  geolocation:
    type: http         # âœ… å¿…é¡»å£°æ˜ç±»å‹
    behavior: domain
    url: "https://gh-proxy.com/https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/proxy.txt"
    path: ./rules/geolocation.yaml
    interval: 86400
    format: text    # ğŸ“œ æ˜¾å¼å£°æ˜æ–‡æœ¬æ ¼å¼
    health-check: false       # å½“è§„åˆ™æ–‡ä»¶æ›´æ–°æ—¶ ä¸è§¦å‘ ä»£ç†èŠ‚ç‚¹çš„å¥åº·æ£€æŸ¥ é¿å…è§„åˆ™æ›´æ–°ä¸èŠ‚ç‚¹æ£€æµ‹äº§ç”Ÿå¾ªç¯ä¾èµ–

  # ğŸ‡¨ğŸ‡³å›½å†…IP
  cn_ip:
    type: http         # âœ… å¿…é¡»å£°æ˜ç±»å‹
    behavior: ipcidr  # ğŸŒIPæ®µåŒ¹é…
    url: "https://gh-proxy.com/https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/cncidr.txt"
    path: ./rules/cn_ip.yaml
    interval: 259200  # ğŸ”„3å¤©æ›´æ–°
    format: text    # ğŸ“œ æ˜¾å¼å£°æ˜æ–‡æœ¬æ ¼å¼
    health-check: false       # å½“è§„åˆ™æ–‡ä»¶æ›´æ–°æ—¶ ä¸è§¦å‘ ä»£ç†èŠ‚ç‚¹çš„å¥åº·æ£€æŸ¥ é¿å…è§„åˆ™æ›´æ–°ä¸èŠ‚ç‚¹æ£€æµ‹äº§ç”Ÿå¾ªç¯ä¾èµ–

rules:
  - RULE-SET,private,DIRECT  # ğŸ”’ç§æœ‰ç½‘ç»œç›´è¿
  - GEOIP,CN,DIRECT  # ğŸ‡¨ğŸ‡³å›½å†…IPç›´è¿
  - RULE-SET,cn_domain,DIRECT  # ğŸ å›½å†…åŸŸå
  - RULE-SET,cn_ip,DIRECT  # ğŸŒå›½å†…IPæ®µ
  - RULE-SET,geolocation,ğŸŒ PROXY  # ğŸŒæµ·å¤–æµé‡
  - MATCH,ğŸŒ PROXY  # ğŸš¦å‰©ä½™æµé‡ä»£ç†